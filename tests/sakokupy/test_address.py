from sakokupy import address

_list = [["41.0.0.0", 2097152],
         ["41.32.0.0", 1048576],
         ["41.48.0.0", 524288],
         ["41.56.0.0", 65536],
         ["41.57.0.0", 16384],
         ["217.77.224.0", 4096],
         ["217.151.192.0", 4096],
         ["217.151.208.0", 4096],
         ["217.173.176.0", 4096],
         ["217.197.80.0", 4096]]


def test_get_end():

    exp = [['41.0.0.0', '41.31.255.255'],
           ['41.32.0.0', '41.47.255.255'],
           ['41.48.0.0', '41.55.255.255'],
           ['41.56.0.0', '41.56.255.255'],
           ['41.57.0.0', '41.57.63.255'],
           ['217.77.224.0', '217.77.239.255'],
           ['217.151.192.0', '217.151.207.255'],
           ['217.151.208.0', '217.151.223.255'],
           ['217.173.176.0', '217.173.191.255'],
           ['217.197.80.0', '217.197.95.255']]

    result = list(map(lambda x:
                      [str(x['start']), str(x['end'])],
                      address.get_end(_list)))

    assert result == exp


def test_get_network():

    exp = ['41.0.0.0/11',
           '41.32.0.0/12',
           '41.48.0.0/13',
           '41.56.0.0/16',
           '41.57.0.0/18',
           '217.77.224.0/20',
           '217.151.192.0/20',
           '217.151.208.0/20',
           '217.173.176.0/20',
           '217.197.80.0/20']

    result = list(map(lambda x: str(x),
                      address.get_network(address.get_end(_list))))

    assert result == exp


def test_organize_network():

    exp = [
        '41.0.0.0/11',
        '41.32.0.0/12',
        '41.48.0.0/13',
        '41.56.0.0/16',
        '41.57.0.0/18',
        '217.77.224.0/20',
        '217.151.192.0/19',
        '217.173.176.0/20',
        '217.197.80.0/20']

    result = list(map(lambda x: str(x),
                      address.organize_network(
                          address.get_network(
                              address.get_end(_list)))))

    assert result == exp
